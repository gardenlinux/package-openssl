From 0c3d66a46eda9353f80e1846642b9090a8eac999 Mon Sep 17 00:00:00 2001
From: Tomas Mraz <tomas@openssl.org>
Date: Tue, 3 Sep 2024 12:24:58 +0200
Subject: [PATCH 122/125] Add CVE-2024-5535 to CHANGES and NEWS

Reviewed-by: Neil Horman <nhorman@openssl.org>
Release: yes
---
 CHANGES.md | 13 ++++++++++++-
 NEWS.md    | 11 +++++++++--
 2 files changed, 21 insertions(+), 3 deletions(-)

diff --git a/CHANGES.md b/CHANGES.md
index 82f45036cf..df9998f757 100644
--- a/CHANGES.md
+++ b/CHANGES.md
@@ -35,10 +35,20 @@ OpenSSL 3.2
    an X.509 certificate. This may result in an exception that terminates the
    application program.
 
-   [(CVE-2024-6119)]
+   ([CVE-2024-6119])
 
    *Viktor Dukhovni*
 
+ * Fixed possible buffer overread in SSL_select_next_proto().
+
+   Calling the OpenSSL API function SSL_select_next_proto with an empty
+   supported client protocols buffer may cause a crash or memory contents
+   to be sent to the peer.
+
+   ([CVE-2024-5535])
+
+   *Matt Caswell*
+
 ### Changes between 3.2.1 and 3.2.2 [4 Jun 2024]
 
  * Fixed potential use after free after SSL_free_buffers() is called.
@@ -20486,6 +20496,7 @@ ndif
 <!-- Links -->
 
 [CVE-2024-6119]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-6119
+[CVE-2024-5535]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-5535
 [CVE-2024-4741]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-4741
 [CVE-2024-4603]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-4603
 [CVE-2024-2511]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-2511
diff --git a/NEWS.md b/NEWS.md
index da025780f7..6eb1d7fb52 100644
--- a/NEWS.md
+++ b/NEWS.md
@@ -22,10 +22,16 @@ OpenSSL 3.2
 
 ### Major changes between OpenSSL 3.2.2 and OpenSSL 3.2.3 [under development]
 
-OpenSSL 3.3.2 is a security patch release. The most severe CVE fixed in this
+OpenSSL 3.2.3 is a security patch release. The most severe CVE fixed in this
 release is Moderate.
 
-  * Fixed possible denial of service in X.509 name checks [(CVE-2024-6119)].
+This release incorporates the following bug fixes and mitigations:
+
+  * Fixed possible denial of service in X.509 name checks
+    ([CVE-2024-6119])
+
+  * Fixed possible buffer overread in SSL_select_next_proto()
+    ([CVE-2024-5535])
 
 ### Major changes between OpenSSL 3.2.1 and OpenSSL 3.2.2 [4 Jun 2024]
 
@@ -1608,6 +1614,7 @@ OpenSSL 0.9.x
 <!-- Links -->
 
 [CVE-2024-6119]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-6119
+[CVE-2024-5535]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-5535
 [CVE-2024-4741]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-4741
 [CVE-2024-4603]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-4603
 [CVE-2024-2511]: https://www.openssl.org/news/vulnerabilities.html#CVE-2024-2511
-- 
2.39.5 (Apple Git-154)

